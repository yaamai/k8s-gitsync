test_recursive_load:
- desc: empty
  files: {}
  manifests: []
- desc: k8s manifest
  files:
    hoge.yaml: |
      ---
      metadata:
        name: a
        namespace: b
      kind: Pod
  manifests:
  - metadata:
      name: a
      namespace: b
    kind: Pod
- desc: k8s manifest load order
  files:
    001-hoge.yaml: |
      ---
      metadata:
        name: 001
      kind: Pod
    100-hoge.yaml: |
      ---
      metadata:
        name: 100
      kind: Pod
  manifests:
  - metadata:
      name: 001
    kind: Pod
  - metadata:
      name: 100
    kind: Pod
- desc: helm manifest
  files:
    hoge.helm: |
      ---
      name: hoge
      namespace: hoge
      chart:
        name: hoge
        version: 1.0.0
        repo: https://hoge.internal
    hoge.values.yaml: |
      a: 100
    fuga.values.yaml: |
      a: 200
      b: 100
  manifests:
  - name: hoge
    namespace: hoge
    chart:
      name: hoge
      version: 1.0.0
      repo: https://hoge.internal
    values:
      a: 100
- desc: helm manifest order
  files:
    001.values.yaml: |
      a: 001
    001.helm: |
      ---
      name: 001
      chart:
        name: a
        version: 1.1.1
    100.helm: |
      ---
      name: 100
      chart:
        name: a
        version: 1.1.1
  manifests:
  - name: 001
    chart:
      name: a
      version: 1.1.1
    values:
      a: 001
  - name: 100
    chart:
      name: a
      version: 1.1.1
    values: {}
- desc: helm k8s mixed
  files:
    001.values.yaml: |
      a: 001
    010.yaml: |
      kind: Pod
      metadata:
        name: 010
    001.helm: |
      ---
      name: 001
      chart:
        name: a
        version: 1.1.1
    100.helm: |
      ---
      name: 100
      chart:
        name: a
        version: 1.1.1
  manifests:
  - name: 001
    chart:
      name: a
      version: 1.1.1
    values:
      a: 001
  - metadata:
      name: 010
    kind: Pod
  - name: 100
    chart:
      name: a
      version: 1.1.1
    values: {}
- desc: separate in subdirs
  files:
    hoge/hoge.helm: |
      name: hoge
      chart:
        name: a
        version: 1.1.1
    hoge/hoge.values.yaml: |
      hoge: True
    hoge.values.yaml: |
      hoge: False
    foo/foo.yaml: |
      kind: Pod
      metadata:
        name: a
        namespace: b
    bar.yaml: |
      kind: Pod
      metadata:
        name: a
        namespace: b
  manifests:
  - name: hoge
    chart:
      name: a
      version: 1.1.1
    values:
      hoge: True
  - kind: Pod
    metadata:
      name: a
      namespace: b
  - kind: Pod
    metadata:
      name: a
      namespace: b
